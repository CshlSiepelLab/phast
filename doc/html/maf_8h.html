<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>PHAST: maf.h File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<div class="nav">
<a class="el" href="dir_000005.html">include</a></div>
<h1>maf.h File Reference</h1>Reading of alignments from MAF ("Multiple Alignment Format") files, as produced by MULTIZ and TBA. <a href="#_details">More...</a>
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structMSA.html">MSA</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="maf_8h.html#a0">maf_read</a> (FILE *F, FILE *REFSEQF, int tuple_size, char *alphabet, <a class="el" href="structGFF__Set.html">GFF_Set</a> *gff, <a class="el" href="structCategoryMap.html">CategoryMap</a> *cm, int cycle_size, int store_order, char *reverse_groups, int gap_strip_mode, int keep_overlapping)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read an alignment from a MAF file.  <a href="#a0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="maf_8h.html#a1">maf_read_block</a> (FILE *F, <a class="el" href="structMSA.html">MSA</a> *mini_msa, Hashtable *name_hash, int *start_idx, int *length, int do_toupper)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read a block from an MAF file and store it as a "mini-msa" using the provided object.  <a href="#a1"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Reading of alignments from MAF ("Multiple Alignment Format") files, as produced by MULTIZ and TBA. 
<p>
(See <a href="http://www.bx.psu.edu/miller_lab.">http://www.bx.psu.edu/miller_lab.</a>) These functions are primarily concerned with extracting sufficient statistics from a MAF file (see <a class="el" href="sufficient__stats_8c.html">sufficient_stats.c</a>). They avoid representing the alignment explicitly, and as a result allow large MAF files (e.g., spanning whole mammalian chromosomes) to be read and stored fairly efficiently. A "reference sequence" alignment is currently assumed, with the reference sequence appearing first in each alignment block, and always in the positive (rather than reverse complemented) orientation (this is the convention with MULTIZ).<hr><h2>Function Documentation</h2>
<a class="anchor" name="a0" doxytag="maf.h::maf_read"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="structMSA.html">MSA</a>* maf_read           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">FILE *&nbsp;</td>
          <td class="mdname" nowrap> <em>F</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>FILE *&nbsp;</td>
          <td class="mdname" nowrap> <em>REFSEQF</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>tuple_size</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>alphabet</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structGFF__Set.html">GFF_Set</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>gff</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structCategoryMap.html">CategoryMap</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>cm</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cycle_size</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>store_order</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>reverse_groups</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>gap_strip_mode</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>keep_overlapping</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Read an alignment from a MAF file. 
<p>
The alignment won't be constructed explicitly; instead, a sufficient-statistics representation will be extracted directly from the MAF. Blocks corresponding to overlapping segments of the reference sequence are permitted, but all except the first one will be discarded. <dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>F</em>&nbsp;</td><td>
MAF file </td></tr>
<tr><td valign="top"><em>REFSEQF</em>&nbsp;</td><td>
optional reference sequence. If non-NULL, the indicated file will be used to define bases in regions of no alignment (not represented in the MAF). File format is expected to be FASTA. Ignored if store_order == FALSE. If NULL and store_order == TRUE, then bases in reference seq not present in MAF are represented as Ns </td></tr>
<tr><td valign="top"><em>tuple_size</em>&nbsp;</td><td>
tuple size for sufficient statistics </td></tr>
<tr><td valign="top"><em>alphabet</em>&nbsp;</td><td>
alphabet for alignment; if NULL, DEFAULT_ALPHABET is assumed </td></tr>
<tr><td valign="top"><em>gff</em>&nbsp;</td><td>
optional <a class="el" href="structGFF__Set.html">GFF_Set</a>. If non-NULL, category-specific counts will be collected (cm must be non-NULL also). The gff is assumed to use the indexing system of the reference sequence (sequence 1). Currently, a non-NULL gff implies gap_strip_mode == 1 (projection onto reference sequence). </td></tr>
<tr><td valign="top"><em>cm</em>&nbsp;</td><td>
Used for category-specific counts, ignored otherwise </td></tr>
<tr><td valign="top"><em>cycle_size</em>&nbsp;</td><td>
Label site categories 12...&lt;cycle_size&gt;...12...&lt;cycle_size&gt; instead of using gff and cm. Useful when stats are to be collected for non-overlapping tuples. Use -1 to ignore. </td></tr>
<tr><td valign="top"><em>store_order</em>&nbsp;</td><td>
Whether to store order in which tuples occur. Storing order requires more memory and larger files, and is not necessary in many cases. </td></tr>
<tr><td valign="top"><em>reverse_groups</em>&nbsp;</td><td>
Tag defining groups in gff; indicates groups on negative strand should be reverse complemented. Ignored if NULL. Useful when collecting counts for strand-specific categories. Can't be used if store_order == TRUE </td></tr>
<tr><td valign="top"><em>gap_strip_mode</em>&nbsp;</td><td>
Gap stripping mode. Currently, if store_order == 1, may only have value NO_STRIP or 1 (indicating projection onto sequence 1, the reference sequence). This is simply to avoid some complexity in coordinate mapping. </td></tr>
<tr><td valign="top"><em>keep_overlapping</em>&nbsp;</td><td>
If TRUE, keep overlapping blocks, otherwise keep only first instance. Must be FALSE if store_order == TRUE or gff != NULL or cycle_size != -1 </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="maf.h::maf_read_block"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int maf_read_block           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">FILE *&nbsp;</td>
          <td class="mdname" nowrap> <em>F</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structMSA.html">MSA</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>mini_msa</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>Hashtable *&nbsp;</td>
          <td class="mdname" nowrap> <em>name_hash</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>start_idx</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>length</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>do_toupper</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Read a block from an MAF file and store it as a "mini-msa" using the provided object. 
<p>
Allocates memory for sequences if they are NULL (as with first block). Reads to next "a" line or EOF. Returns EOF when no more alignments are available. Sets start coord and length of reference sequence if non-NULL pointers are provided. Uses provided hash to map sequence names to sequence indices (prefix of name wrt '.' character); sequences not present in a block will be represented by missing-data characters.     </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Wed Oct 11 16:34:18 2006 for PHAST by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
