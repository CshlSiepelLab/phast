<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>category_map.h File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.15 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="modules.html">Modules</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>category_map.h File Reference</h1>Mapping between feature types and site categories. 
<a href="#_details">More...</a>
<p>
<table border=0 cellpadding=0 cellspacing=0>
<tr><td colspan=2><br><h2>Compounds</h2></td></tr>
<tr><td nowrap align=right valign=top>struct &nbsp;</td><td valign=bottom><a class="el" href="structCategoryMap.html">CategoryMap</a></td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Category map object.</em> <a href="structCategoryMap.html#_details">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>struct &nbsp;</td><td valign=bottom><a class="el" href="structCategoryRange.html">CategoryRange</a></td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Represents range of categories for a given type.</em> <a href="structCategoryRange.html#_details">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>struct &nbsp;</td><td valign=bottom><a class="el" href="structUnspooler.html">Unspooler</a></td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Allows "unspooling" of <a class="el" href="structCategoryMap.html">CategoryMap</a>, i.e., a mapping from the original categories to a larger set that allows for categories to be "conditioned on" other categories.</em> <a href="structUnspooler.html#_details">More...</a><em></em></font><br><br></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td nowrap align=right valign=top><a name="a0" doxytag="category_map.h::BACKGD_CAT_NAME"></a>
#define&nbsp;</td><td valign=bottom><a class="el" href="category__map_8h.html#a0">BACKGD_CAT_NAME</a>&nbsp;&nbsp;&nbsp;"background"</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Name of background category.</em></font><br><br></td></tr>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td nowrap align=right valign=top><a name="a3" doxytag="category_map.h::cm_create_trivial"></a>
<a class="el" href="structCategoryMap.html">CategoryMap</a> *&nbsp;</td><td valign=bottom><a class="el" href="category__map_8h.html#a3">cm_create_trivial</a> (int ncats, char *feature_prefix)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Create a trivial <a class="el" href="structCategoryMap.html">CategoryMap</a>, with feature types equal to category numbers (plus an optional prefix) and ranges all of size one.</em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="structCategoryMap.html">CategoryMap</a> *&nbsp;</td><td valign=bottom><a class="el" href="category__map_8h.html#a4">cm_new_from_features</a> (<a class="el" href="structGFF__Set.html">GFF_Set</a> *feats)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Create a category map with a category for each feature type in a <a class="el" href="structGFF__Set.html">GFF_Set</a>.</em> <a href="#a4">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="structCategoryMap.html">CategoryMap</a> *&nbsp;</td><td valign=bottom><a class="el" href="category__map_8h.html#a5">cm_new_string_or_file</a> (char *optarg)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Create a new category map from a string that can either be a filename or a brief "inlined" category map, e.g., "NCATS = 3 ; CDS 1-3".</em> <a href="#a5">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top><a name="a6" doxytag="category_map.h::cm_realloc"></a>
void&nbsp;</td><td valign=bottom><a class="el" href="category__map_8h.html#a6">cm_realloc</a> (<a class="el" href="structCategoryMap.html">CategoryMap</a> *cm, int ncats)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Reallocate a category map to allow for the specified size.</em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top><a name="a7" doxytag="category_map.h::cm_free"></a>
void&nbsp;</td><td valign=bottom><a class="el" href="category__map_8h.html#a7">cm_free</a> (<a class="el" href="structCategoryMap.html">CategoryMap</a> *cm)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Free memory associated with category map.</em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top><a name="a8" doxytag="category_map.h::cm_read"></a>
<a class="el" href="structCategoryMap.html">CategoryMap</a> *&nbsp;</td><td valign=bottom><a class="el" href="category__map_8h.html#a8">cm_read</a> (FILE *F)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Read a <a class="el" href="structCategoryMap.html">CategoryMap</a> from a file.</em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="category__map_8h.html#a9">cm_get_category</a> (<a class="el" href="structCategoryMap.html">CategoryMap</a> *cm, String *type)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Return the 'base' category for a given feature type (first category in range).</em> <a href="#a9">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top><a name="a10" doxytag="category_map.h::cm_get_category_list"></a>
<a class="el" href="structList.html">List</a> *&nbsp;</td><td valign=bottom><a class="el" href="category__map_8h.html#a10">cm_get_category_list</a> (<a class="el" href="structCategoryMap.html">CategoryMap</a> *cm, <a class="el" href="structList.html">List</a> *names, int ignore_missing)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Return a list of category numbers corresponding to a given list of category names and or numbers.</em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>String *&nbsp;</td><td valign=bottom><a class="el" href="category__map_8h.html#a11">cm_get_feature</a> (<a class="el" href="structCategoryMap.html">CategoryMap</a> *cm, int cat)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Retrieve the (primary) feature type associated with the specified category number.</em> <a href="#a11">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>String *&nbsp;</td><td valign=bottom><a class="el" href="category__map_8h.html#a12">cm_get_feature_unique</a> (<a class="el" href="structCategoryMap.html">CategoryMap</a> *cm, int cat)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Obtain a unique name based on the (primary) feature type associated with the specified category number.</em> <a href="#a12">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top><a name="a14" doxytag="category_map.h::cm_print"></a>
void&nbsp;</td><td valign=bottom><a class="el" href="category__map_8h.html#a14">cm_print</a> (<a class="el" href="structCategoryMap.html">CategoryMap</a> *cm, FILE *F)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Print a <a class="el" href="structCategoryMap.html">CategoryMap</a> to a file.</em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="category__map_8h.html#a15">cm_add_feature_type</a> (<a class="el" href="structCategoryMap.html">CategoryMap</a> *cm, String *type, int cycle_size)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Add new feature to <a class="el" href="structCategoryMap.html">CategoryMap</a>.</em> <a href="#a15">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>void&nbsp;</td><td valign=bottom><a class="el" href="category__map_8h.html#a20">cm_spooled_to_unspooled</a> (<a class="el" href="structCategoryMap.html">CategoryMap</a> *cm, int *path, int pathlen)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>maps a sequence (array) of category numbers from the spooled space to the unspooled space, using the current unspooler.</em> <a href="#a20">More...</a><em></em></font><br><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Mapping between feature types and site categories.
<p>

<p>
Category maps allow arbitrary 'features' (e.g., CDSs, UTRs, introns, ancestral repeats, CpG islands), as specified in an annotations file (e.g., GFF or BED), to be mapped to numbered site "categories" which can be treated separately in various analyses. They also allow a mapping backwards from site categories to features. Given a category map and a set of annotations, the sites of an alignment can unambiguously be labeled by category, and conversely, given a category map and an alignment whose sites are labeled by category, a set of annotations can be produced unambiguously.
<p>
Category maps work as follows. Each feature is defined by a 'type' (a string), and each category by an integer. Category numbers must run consecutively from 1 to the total number of categories (but they need not be defined in order). Categories fall into 'category ranges', each of which spans a sequence of consecutive integers. A 'simple' feature type has a category range of size one, and a 'cyclic' feature type has a range of size greater than one. Multiple types may map to the same category number, but if they are cyclic, the ranges must coincide exactly. The mapping from feature types to category numbers is unambiguous. To allow mapping in the other direction, however, one type associated with a given category is designated as 'primary'. By convention, the first type to be defined is considered the primary type. Category 0 is reserved as the 'background' or 'default' category (all other categories stand in relief to this category).
<p>
The system is best understood by considering an example of a category file:
<p>
<pre>
   NCATS = 6

   CDS         1-3
   intron      4
   5'UTR       5
   3'UTR       6
   start_codon 1-3
   stop_codon  1-3
   5'splice    4 
   3'splice    4
   </pre>
<p>
The NCATS line must appear first; it defines the number of categories. Blank lines are ignored throughout. The remaining lines define category ranges. Each one must have two or three columns separated by whitespace. The first column gives the feature type and the second the range of category numbers. Strings of the form 'a-b' indicate cyclic feature types, and single integers indicate simple feature types. Here CDS, start_codon, and stop_codon are cyclic feature types, mapped to the same range, 1-3 (CDS is the primary feature type). The others are all simple types.
<p>
This example illustrates how a category map can be used to "project" a relatively large set of features onto a small set of categories. It's sometimes useful to generate an extensive set of annotations, then to have multiple category maps that "collapse" categories in various ways. For example, suppose we wanted to collapse the features above even further, to consider just coding and noncoding sites. We could use:
<p>
<pre>
   NCATS = 1

   CDS         1
   start_codon 1
   stop_codon  1
   </pre>
<p>
Here we take advantage of the fact that all undefined feature types will map to the 'background' category (category 0).
<p>
<hr><h2>Function Documentation</h2>
<a name="a15" doxytag="category_map.h::cm_add_feature_type"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void cm_add_feature_type </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structCategoryMap.html">CategoryMap</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>cm</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>String *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>type</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>cycle_size</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Add new feature to <a class="el" href="structCategoryMap.html">CategoryMap</a>.
<p>
Assumes a feature of the specified type does not already exist.     </td>
  </tr>
</table>
<a name="a9" doxytag="category_map.h::cm_get_category"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int cm_get_category </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structCategoryMap.html">CategoryMap</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>cm</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>String *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>type</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Return the 'base' category for a given feature type (first category in range).
<p>
Returns 0 (background) if no match.     </td>
  </tr>
</table>
<a name="a11" doxytag="category_map.h::cm_get_feature"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> String* cm_get_feature </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structCategoryMap.html">CategoryMap</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>cm</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>cat</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Retrieve the (primary) feature type associated with the specified category number.
<p>
Note: return value is passed by reference -- do not alter.     </td>
  </tr>
</table>
<a name="a12" doxytag="category_map.h::cm_get_feature_unique"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> String* cm_get_feature_unique </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structCategoryMap.html">CategoryMap</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>cm</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>cat</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Obtain a unique name based on the (primary) feature type associated with the specified category number.
<p>
Returns a pointer to a newly allocated String.     </td>
  </tr>
</table>
<a name="a4" doxytag="category_map.h::cm_new_from_features"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="structCategoryMap.html">CategoryMap</a>* cm_new_from_features </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structGFF__Set.html">GFF_Set</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>feats</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Create a category map with a category for each feature type in a <a class="el" href="structGFF__Set.html">GFF_Set</a>.
<p>
Category numbers are assigned in order of appearance of types     </td>
  </tr>
</table>
<a name="a5" doxytag="category_map.h::cm_new_string_or_file"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="structCategoryMap.html">CategoryMap</a>* cm_new_string_or_file </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>optarg</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Create a new category map from a string that can either be a filename or a brief "inlined" category map, e.g., "NCATS = 3 ; CDS 1-3".
<p>
Useful for command-line arguments.     </td>
  </tr>
</table>
<a name="a20" doxytag="category_map.h::cm_spooled_to_unspooled"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void cm_spooled_to_unspooled </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structCategoryMap.html">CategoryMap</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>cm</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>path</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>pathlen</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
maps a sequence (array) of category numbers from the spooled space to the unspooled space, using the current unspooler.
<p>
Original sequence is overwritten     </td>
  </tr>
</table>
<hr><address align="right"><small>Generated on Tue Jun 15 15:55:36 2004 for PHAST by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.15 </small></address>
</body>
</html>
