<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>PHAST: phylo_hmm.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<div class="nav">
<a class="el" href="dir_000000.html">src</a>&nbsp;/&nbsp;<a class="el" href="dir_000002.html">lib</a>&nbsp;/&nbsp;<a class="el" href="dir_000010.html">phylo_hmm</a></div>
<h1>phylo_hmm.c File Reference</h1>Code for phylo-HMMs. <a href="#_details">More...</a>
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">PhyloHmm *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="phylo__hmm_8c.html#a4">phmm_new</a> (HMM *hmm, TreeModel **tree_models, <a class="el" href="structCategoryMap.html">CategoryMap</a> *cm, <a class="el" href="structlst__struct.html">List</a> *pivot_cats, indel_mode_type indel_mode)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a new PhyloHmm object.  <a href="#a4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="phylo__hmm_8c.html#a7">phmm_rates_cross</a> (PhyloHmm *phmm, int nratecats, double lambda, int expand_cats)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Scale tree models and replace HMM by its cross-product with an autocorr HMM defined by 'lambda'.  <a href="#a7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="phylo__hmm_8c.html#a10">phmm_compute_emissions</a> (PhyloHmm *phmm, <a class="el" href="structMSA.html">MSA</a> *msa, int quiet)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute emissions for given PhyloHmm and <a class="el" href="structMSA.html">MSA</a>.  <a href="#a10"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structGFF__Set.html">GFF_Set</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="phylo__hmm_8c.html#a11">phmm_predict_viterbi</a> (PhyloHmm *phmm, char *seqname, char *grouptag, char *idpref, <a class="el" href="structlst__struct.html">List</a> *frame)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Run the Viterbi algorithm and return a set of predictions.  <a href="#a11"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structGFF__Set.html">GFF_Set</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="phylo__hmm_8c.html#a12">phmm_predict_viterbi_cats</a> (PhyloHmm *phmm, <a class="el" href="structlst__struct.html">List</a> *cats, char *seqname, char *grouptag, char *idpref, <a class="el" href="structlst__struct.html">List</a> *frame, char *new_type)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Run the Viterbi algorithm and return a set of features indicating regions in which the Viterbi path remains in states corresponding to any of the specified categories.  <a href="#a12"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="phylo__hmm_8c.html#a13">phmm_lnl</a> (PhyloHmm *phmm)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute and return log likelihood.  <a href="#a13"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="phylo__hmm_8c.html#a14">phmm_postprobs</a> (PhyloHmm *phmm, double **post_probs)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Computes posterior probabilities for a PhyloHmm.  <a href="#a14"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="phylo__hmm_8c.html#a15">phmm_postprobs_cats</a> (PhyloHmm *phmm, <a class="el" href="structlst__struct.html">List</a> *cats, double *lnl)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Computes and returns an array of length phmm-&gt;alloc_len representing the marginal posterior prob at every site, summed over states corresponding to categories in the specified list.  <a href="#a15"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="phylo__hmm_8c.html#a18">phmm_score_predictions</a> (PhyloHmm *phmm, <a class="el" href="structGFF__Set.html">GFF_Set</a> *preds, <a class="el" href="structlst__struct.html">List</a> *score_cats, <a class="el" href="structlst__struct.html">List</a> *helper_cats, <a class="el" href="structlst__struct.html">List</a> *null_cats, int score_only_score_cats)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Score a set of predicted features using log odds scoring.  <a href="#a18"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="phylo__hmm_8c.html#a19">phmm_add_bias</a> (PhyloHmm *phmm, <a class="el" href="structlst__struct.html">List</a> *backgd_cat_names, double bias)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add specified "bias" to log transition probabilities from designated background categories to non-background categories, then renormalize.  <a href="#a19"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="phylo__hmm_8c.html#a24">phmm_fit_em</a> (PhyloHmm *phmm, <a class="el" href="structMSA.html">MSA</a> *msa, int fix_functional, int fix_indel, FILE *logf)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">General routine to estimate the parameters of a phylo-HMM by EM.  <a href="#a24"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Code for phylo-HMMs. 
<p>
Allows for automatic expansion of the state space to accommodate features on the reverse strand, and for the indel model described in Siepel &amp; Haussler, RECOMB '04. Also allows for cross-product constructions involving functional states and rate categories (Siepel &amp; Haussler, RECOMB '03).<hr><h2>Function Documentation</h2>
<a class="anchor" name="a19" doxytag="phylo_hmm.c::phmm_add_bias"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void phmm_add_bias           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PhyloHmm *&nbsp;</td>
          <td class="mdname" nowrap> <em>phmm</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structlst__struct.html">List</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>backgd_cat_names</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>bias</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Add specified "bias" to log transition probabilities from designated background categories to non-background categories, then renormalize. 
<p>
Provides a simple "knob" for controlling the sensitivity/specificity tradeoff. Bias may be negative (increases specificity) or positive (increases sensitivity).     </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="phylo_hmm.c::phmm_compute_emissions"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void phmm_compute_emissions           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PhyloHmm *&nbsp;</td>
          <td class="mdname" nowrap> <em>phmm</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structMSA.html">MSA</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>msa</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>quiet</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Compute emissions for given PhyloHmm and <a class="el" href="structMSA.html">MSA</a>. 
<p>
Preprocessor for phmm_viterbi_features, phmm_posterior_probs, and phmm_lnl (often only needs to be run once). <dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>phmm</em>&nbsp;</td><td>
Initialized PhyloHmm </td></tr>
<tr><td valign="top"><em>msa</em>&nbsp;</td><td>
Source alignment </td></tr>
<tr><td valign="top"><em>quiet</em>&nbsp;</td><td>
Determins whether progress is reported to stderr </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="a24" doxytag="phylo_hmm.c::phmm_fit_em"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double phmm_fit_em           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PhyloHmm *&nbsp;</td>
          <td class="mdname" nowrap> <em>phmm</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structMSA.html">MSA</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>msa</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>fix_functional</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>fix_indel</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>FILE *&nbsp;</td>
          <td class="mdname" nowrap> <em>logf</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
General routine to estimate the parameters of a phylo-HMM by EM. 
<p>
Can be used with or without the indel model, and for estimation of transition params only or transition params and tree models. Returns ln likelihood. <dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>fix_functional</em>&nbsp;</td><td>
NULL means not to estimate tree models (emissions must be precomputed) Whether to fix transition parameters of functional HMM </td></tr>
<tr><td valign="top"><em>fix_indel</em>&nbsp;</td><td>
Whether to fix indel parameters </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="phylo_hmm.c::phmm_lnl"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double phmm_lnl           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PhyloHmm *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>phmm</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Compute and return log likelihood. 
<p>
Uses forward algorithm. Emissions must have already been computed (see phmm_compute_emissions)     </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="phylo_hmm.c::phmm_new"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">PhyloHmm* phmm_new           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HMM *&nbsp;</td>
          <td class="mdname" nowrap> <em>hmm</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>TreeModel **&nbsp;</td>
          <td class="mdname" nowrap> <em>tree_models</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structCategoryMap.html">CategoryMap</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>cm</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structlst__struct.html">List</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pivot_cats</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>indel_mode_type&nbsp;</td>
          <td class="mdname" nowrap> <em>indel_mode</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Create a new PhyloHmm object. 
<p>
Optionally expands original HMM to allow for features on both the positive and negative strands. <dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>hmm</em>&nbsp;</td><td>
HMM. If indel_mode == MISSING_DATA or indel_mode == PARAMETERIC, then an HMM for functional cateogories (with nstates == cm-&gt;ncats + 1) should be passed in; otherwise (indel_mode == NONPARAMETERIC), an hmm for the full gapped (but not 'reflected') phylo-HMM should be passed in. NULL may also be given, in which case a trivial, single-state HMM will be created. Any HMM that is passed in will be left unchanged (a copy will be created) </td></tr>
<tr><td valign="top"><em>tree_models</em>&nbsp;</td><td>
Array of TreeModel objects. Number of elements is assumed to equal number of categories (cm-&gt;ncats+1) </td></tr>
<tr><td valign="top"><em>cm</em>&nbsp;</td><td>
<a class="el" href="structCategoryMap.html">CategoryMap</a>. A copy is created, orig. isn't touched. If NULL, a trivial map is created, with a separate category for every HMM state. Must be non-NULL if indel_mode != MISSING_DATA. </td></tr>
<tr><td valign="top"><em>pivot_cats</em>&nbsp;</td><td>
Categories (by name or number) about which to "reflect" the HMM. Allows for prediction on both strands (see hmm_reverse_compl). Pass NULL for no reflection </td></tr>
<tr><td valign="top"><em>indel_mode</em>&nbsp;</td><td>
How to model indels. Allowable values are MISSING_DATA, PARAMETERIC, and NONPARAMETERIC. </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="phylo_hmm.c::phmm_postprobs"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double phmm_postprobs           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PhyloHmm *&nbsp;</td>
          <td class="mdname" nowrap> <em>phmm</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double **&nbsp;</td>
          <td class="mdname" nowrap> <em>post_probs</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Computes posterior probabilities for a PhyloHmm. 
<p>
Emissions must have already been computed (see phmm_compute_emissions). Returns log likelihood.     </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="phylo_hmm.c::phmm_postprobs_cats"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">double* phmm_postprobs_cats           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PhyloHmm *&nbsp;</td>
          <td class="mdname" nowrap> <em>phmm</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structlst__struct.html">List</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>cats</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double *&nbsp;</td>
          <td class="mdname" nowrap> <em>lnl</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Computes and returns an array of length phmm-&gt;alloc_len representing the marginal posterior prob at every site, summed over states corresponding to categories in the specified list. 
<p>
Emissions must have already been computed (see phmm_compute_emissions). Computes log likelihood as a side effect. <dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>phmm</em>&nbsp;</td><td>
PhyloHmm object </td></tr>
<tr><td valign="top"><em>cats</em>&nbsp;</td><td>
Categories of interest, by name or number </td></tr>
<tr><td valign="top"><em>lnl</em>&nbsp;</td><td>
if non-NULL, will point to log likelihood on return </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="phylo_hmm.c::phmm_predict_viterbi"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="structGFF__Set.html">GFF_Set</a>* phmm_predict_viterbi           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PhyloHmm *&nbsp;</td>
          <td class="mdname" nowrap> <em>phmm</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>seqname</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>grouptag</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>idpref</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structlst__struct.html">List</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>frame</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Run the Viterbi algorithm and return a set of predictions. 
<p>
Emissions must have already been computed (see phmm_compute_emissions) <dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>phmm</em>&nbsp;</td><td>
PhyloHmm object </td></tr>
<tr><td valign="top"><em>seqname</em>&nbsp;</td><td>
seqname for feature set (e.g., "chr1") </td></tr>
<tr><td valign="top"><em>grouptag</em>&nbsp;</td><td>
tag to use for groups (e.g., "exon_id", "transcript_id"); if NULL, a default will be used </td></tr>
<tr><td valign="top"><em>idpref</em>&nbsp;</td><td>
prefix for assigned ids (e.g., "chr1.15") (may be NULL) </td></tr>
<tr><td valign="top"><em>frame</em>&nbsp;</td><td>
names of features for which to obtain frame (NULL to ignore) </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="phylo_hmm.c::phmm_predict_viterbi_cats"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="structGFF__Set.html">GFF_Set</a>* phmm_predict_viterbi_cats           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PhyloHmm *&nbsp;</td>
          <td class="mdname" nowrap> <em>phmm</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structlst__struct.html">List</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>cats</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>seqname</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>grouptag</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>idpref</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structlst__struct.html">List</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>frame</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>new_type</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Run the Viterbi algorithm and return a set of features indicating regions in which the Viterbi path remains in states corresponding to any of the specified categories. 
<p>
Emissions must have already been computed (see phmm_compute_emissions) <dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>phmm</em>&nbsp;</td><td>
PhyloHmm object </td></tr>
<tr><td valign="top"><em>cats</em>&nbsp;</td><td>
categories of interest, by name or number </td></tr>
<tr><td valign="top"><em>seqname</em>&nbsp;</td><td>
seqname for feature set (e.g., "chr1") </td></tr>
<tr><td valign="top"><em>grouptag</em>&nbsp;</td><td>
tag to use for groups (e.g., "exon_id", "transcript_id"); if NULL, a default will be used </td></tr>
<tr><td valign="top"><em>idpref</em>&nbsp;</td><td>
prefix for assigned ids (e.g., "chr1.15") (may be NULL) </td></tr>
<tr><td valign="top"><em>frame</em>&nbsp;</td><td>
features for which to obtain frame (NULL to ignore) </td></tr>
<tr><td valign="top"><em>new_type</em>&nbsp;</td><td>
replace type of each retained feature with this string if non-NULL (old types may no longer make sense, because of merging) </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="phylo_hmm.c::phmm_rates_cross"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void phmm_rates_cross           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PhyloHmm *&nbsp;</td>
          <td class="mdname" nowrap> <em>phmm</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>nratecats</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>double&nbsp;</td>
          <td class="mdname" nowrap> <em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>expand_cats</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Scale tree models and replace HMM by its cross-product with an autocorr HMM defined by 'lambda'. 
<p>
Update all mappings appropriately. Weight-matrix tree models are not scaled. <dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>phmm</em>&nbsp;</td><td>
PhyloHmm to be altered </td></tr>
<tr><td valign="top"><em>nratecats</em>&nbsp;</td><td>
Number of rate categories. </td></tr>
<tr><td valign="top"><em>lambda</em>&nbsp;</td><td>
Autocorrelation parameter </td></tr>
<tr><td valign="top"><em>expand_cats</em>&nbsp;</td><td>
whether to expand the category map to reflect the rate categories (useful, e.g., in prediction of rate categories). Currently not allowed with the indel model, or with any category map having "conditioned_on" dependencies </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="phylo_hmm.c::phmm_score_predictions"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void phmm_score_predictions           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PhyloHmm *&nbsp;</td>
          <td class="mdname" nowrap> <em>phmm</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structGFF__Set.html">GFF_Set</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>preds</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structlst__struct.html">List</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>score_cats</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structlst__struct.html">List</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>helper_cats</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="structlst__struct.html">List</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>null_cats</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>score_only_score_cats</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Score a set of predicted features using log odds scoring. 
<p>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>phmm</em>&nbsp;</td><td>
PhyloHmm object </td></tr>
<tr><td valign="top"><em>preds</em>&nbsp;</td><td>
Predictions to score </td></tr>
<tr><td valign="top"><em>score_cats</em>&nbsp;</td><td>
Categories to score (specify by name or number) </td></tr>
<tr><td valign="top"><em>helper_cats</em>&nbsp;</td><td>
Secondary categories to be included in scoring if adjacent to main cats. Pass NULL if none. </td></tr>
<tr><td valign="top"><em>null_cats</em>&nbsp;</td><td>
Categories in null model. Pass NULL to use all categories not in score_cats or helper_cats </td></tr>
<tr><td valign="top"><em>score_only_score_cats</em>&nbsp;</td><td>
Restrict scoring to features matching score_cats; if FALSE, all features are scored </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Wed Oct 11 16:34:18 2006 for PHAST by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
