<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>maf.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.15 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="modules.html">Modules</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>maf.c File Reference</h1>Reading of alignments from MAF ("Multiple Alignment Format") files, as produced by MULTIZ and TBA. 
<a href="#_details">More...</a>
<p>
<table border=0 cellpadding=0 cellspacing=0>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="structMSA.html">MSA</a> *&nbsp;</td><td valign=bottom><a class="el" href="maf_8c.html#a0">maf_read</a> (FILE *F, FILE *REFSEQF, int tuple_size, <a class="el" href="structGFF__Set.html">GFF_Set</a> *gff, <a class="el" href="structCategoryMap.html">CategoryMap</a> *cm, int cycle_size, int store_order, char *reverse_groups, int gap_strip_mode)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Read an alignment from a MAF file.</em> <a href="#a0">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top>int&nbsp;</td><td valign=bottom><a class="el" href="maf_8c.html#a1">maf_read_block</a> (FILE *F, <a class="el" href="structMSA.html">MSA</a> *mini_msa, Hashtable *name_hash, int *start_idx, int *length)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Read a block from an MAF file and store it as a "mini-msa" using the provided object.</em> <a href="#a1">More...</a><em></em></font><br><br></td></tr>
<tr><td nowrap align=right valign=top><a class="el" href="structMSA.html">MSA</a> *&nbsp;</td><td valign=bottom><a class="el" href="maf_8c.html#a2">maf_read_next_msa</a> (FILE *F)</td></tr>
<tr><td>&nbsp;</td><td><font size=-1><em>Reads a block from an MAF file and returns it as a new <a class="el" href="structMSA.html">MSA</a> object.</em> <a href="#a2">More...</a><em></em></font><br><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Reading of alignments from MAF ("Multiple Alignment Format") files, as produced by MULTIZ and TBA.
<p>
 See <a class="el" href="maf_8h.html">maf.h</a> for details.
<p>
<hr><h2>Function Documentation</h2>
<a name="a0" doxytag="maf.c::maf_read"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="structMSA.html">MSA</a>* maf_read </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">FILE *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>F</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>FILE *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>REFSEQF</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>tuple_size</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="structGFF__Set.html">GFF_Set</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>gff</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="structCategoryMap.html">CategoryMap</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>cm</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>cycle_size</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>store_order</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>reverse_groups</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>gap_strip_mode</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Read an alignment from a MAF file.
<p>
The alignment won't be constructed explicitly; instead, a sufficient-statistics representation will be extracted directly from the MAF. Blocks corresponding to overlapping segments of the reference sequence are permitted, but all except the first one will be discarded. <dl compact><dt><b>
Parameters: </b><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em>F</em>&nbsp;</td><td>
MAF-formatted file </td></tr>
<tr><td valign=top><em>REFSEQF</em>&nbsp;</td><td>
optional reference sequence. If non-NULL, the indicated file will be used to define bases in regions of no alignment (not represented in the MAF). File format is expected to be FASTA. Ignored if store_order == FALSE. If NULL and store_order == TRUE, then bases in reference seq not present in MAF are represented as Ns </td></tr>
<tr><td valign=top><em>tuple_size</em>&nbsp;</td><td>
tuple size for sufficient statistics </td></tr>
<tr><td valign=top><em>gff</em>&nbsp;</td><td>
optional <a class="el" href="structGFF__Set.html">GFF_Set</a>. If non-NULL, category-specific counts will be collected (cm must be non-NULL also). The gff is assumed to use the indexing system of the reference sequence (sequence 1). Currently, a non-NULL gff implies gap_strip_mode == 1 (projection onto reference sequence). </td></tr>
<tr><td valign=top><em>cm</em>&nbsp;</td><td>
Used for category-specific counts, ignored otherwise </td></tr>
<tr><td valign=top><em>cycle_size</em>&nbsp;</td><td>
Label site categories 12...&lt;cycle_size&gt;...12...&lt;cycle_size&gt; instead of using gff and cm. Useful when stats are to be collected for non-overlapping tuples. Use -1 to ignore. </td></tr>
<tr><td valign=top><em>store_order</em>&nbsp;</td><td>
Whether to store order in which tuples occur. Requires more memory and larger files, and is not necessary in many cases. </td></tr>
<tr><td valign=top><em>reverse_groups</em>&nbsp;</td><td>
Tag defining groups in gff; indicates groups on negative strand should be reverse complemented. Ignored if NULL. Useful when collecting counts for strand-specific categories. Can't be used if store_order == TRUE </td></tr>
<tr><td valign=top><em>gap_strip_mode</em>&nbsp;</td><td>
Gap stripping mode. Currently, if store_order == 1, may only have value NO_STRIP or 1 (indicating projection onto sequence 1, the reference sequence). This is simply to avoid some complexity in coordinate mapping. </td></tr>
</table>
</dl>    </td>
  </tr>
</table>
<a name="a1" doxytag="maf.c::maf_read_block"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int maf_read_block </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">FILE *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>F</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="structMSA.html">MSA</a> *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>mini_msa</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>Hashtable *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>name_hash</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>start_idx</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap>&nbsp; <em>length</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Read a block from an MAF file and store it as a "mini-msa" using the provided object.
<p>
Allocates memory for sequences if they are NULL (as with first block). Reads to next "a" line or EOF. Returns EOF when no more alignments are available. Sets start coord and length of reference sequence if non-NULL pointers are provided. Uses provided hash to map sequence names to sequence indices (prefix of name wrt '.' character); sequences not present in a block will be represented by gap characters.     </td>
  </tr>
</table>
<a name="a2" doxytag="maf.c::maf_read_next_msa"></a><p>
<table width="100%" cellpadding="2" cellspacing="0" border="0">
  <tr>
    <td class="md">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="structMSA.html">MSA</a>* maf_read_next_msa </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">FILE *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>&nbsp; <em>F</em>          </td>
          <td class="md" valign="top">)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Reads a block from an MAF file and returns it as a new <a class="el" href="structMSA.html">MSA</a> object.
<p>
Reads to next "a" line or EOF. Returns NULL when no more alignments are available. This is a slightly less efficient but simpler and more flexible version of maf_read_block.     </td>
  </tr>
</table>
<hr><address align="right"><small>Generated on Tue Jun 22 11:33:55 2004 for PHAST by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.15 </small></address>
</body>
</html>
